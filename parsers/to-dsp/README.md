# TO DSP

## Description
This parser helps you create a [Design System Package (DSP)](https://github.com/AdobeXD/design-system-package-dsp).

Learn more about how to configure Specify in the API documentation: [https://specifyapp.com/developers](https://specifyapp.com/developers).

## Interface

```ts
interface x {
  name: 'to-dsp';
  options?: Partial<{
    settings: Partial<{
      name?: string;
      buildStatusLabel?: string;
      packageVersion?: string;
      snippetTriggerPrefix?: string;
    }>;
    createAssets: boolean;
  }>;
}
```

### Options

| Parameter                       | Required | Type     | Default                | Description                                                   |
| ------------------------------- | -------- | -------- | ---------------------- | ------------------------------------------------------------- |
| `settings.name`                 | optional | `string` | 'Generated by Specify' | The name of the DSP                                           |
| `settings.buildStatusLabel`     | optional | `string` |                        | Build status label (examples: 'dev' or 'released')            |
| `settings.packageVersion`       | optional | `string` |                        | Version of the DSP package, not the DSP spec                  |
| `settings.snippetTriggerPrefix` | optional | `string` |                        | Trigger for snippets on components (examples: 'sp-' or 'ex-") |
| `createAssets`                  | true     | `true`   | `true`                 | Defines if you want the assets to be created or not           |


## Output
Please keep in mind that this parser generates files. This is why you should always set a folder as the final `path` in your parent rule.

<details open>
<summary>See Do & Don't config examples</summary>

‚úÖ Do
```
// ...
"rules": [
  {
    "name": "DSP",
    "path": "dsp", // <-- path set as a folder
    "parsers": [
      {
        "name": "to-dsp"
      }
    ]
  }
]
```

üö´ Don't
```
// ...
"rules": [
  {
    "name": "DSP",
    "path": "dsp/dsp.json", // <-- path set as a file
    "parsers": [
      {
        "name": "to-dsp"
      }
    ]
  }
]
```
</details>

## Types

‚ÑπÔ∏è **Please be aware that, depending on the order you use parsers, their input and output types have to match.**

### Input

Array of object with at least name, value and type and id

```ts
Array<{
  id: string;
  name: string;
  value: any;
  type: string;
}>
```

### Output

An array of object containing a name and a value. The value is an object containing either an url or a content. This object is considered as a DownloadableFile

```ts
type output = Array<{
  name: string;
  value: {
    content?: string;
    url?: string;
  };
}>;
```

## Usage

### Config

```jsonc
"parsers": [
  {
    "name": "to-dsp",
    "options": {
      "settings": {
        "name": "My awesome DSP",
        "buildStatusLabel": "test",
        "packageVersion": "0.0.1",
        "snippetTriggerPrefix": "ex-"
      },
      "createAssets": false
    }
  }
  // ‚Ä¶
]
```

### Before/After

#### Input

```jsonc
[
  {
    "type": "color",
    "value": {
      "a": 0.96,
      "b": 20,
      "g": 227,
      "r": 122
    },
    "name": "Primary color"
  }
]
```

#### Output

```jsonc
[
  {
    "name": "data/tokens.json",
    "value": {
      "content":
        "{\n" +
        "    \"dsp_spec_version\": \"0.5.0\",\n" +
        "    \"last_updated_by\": \"Specify\",\n" +
        "    \"last_updated\": \"Wed, 07 Oct 2020 07:58:07 GMT\",\n" +
        "    \"entities\": [\n" +
        "        {\n" +
        "            \"class\": \"token\",\n" +
        "            \"type\": \"color\",\n" +
        "            \"name\": \"Primary color\",\n" +
        "            \"value\": \n" +
                      "{\n" +
                      "    \"a\": \"0.96\",\n" +
                      "    \"b\": \"20\",\n" +
                      "    \"g\": \"227\",\n" +
                      "    \"r\": \"122\",\n" +
                      "}," +
        "            \"tags\": [\n" +
        "                \"specify\",\n" +
        "                \"color\"\n" +
        "            ]\n" +
        "        },\n" +
        "    }\n" +
        "}"
    }
  },
  {
    "name": "data/components.json",
    "value": {
      "content":
        "{\n" +
        "    \"dsp_spec_version\": \"0.5.0\",\n" +
        "    \"last_updated_by\": \"Specify\",\n" +
        "    \"last_updated\": \"Wed, 07 Oct 2020 08:04:22 GMT\",\n" +
        "    \"entities\": []\n" +
        "}"
    }
  },
  {
    "name": "data/fonts.json",
    "value": {
      "content":
        "{\n" +
        "    \"dsp_spec_version\": \"0.5.0\",\n" +
        "    \"last_updated_by\": \"Specify\",\n" +
        "    \"last_updated\": \"Wed, 07 Oct 2020 08:04:22 GMT\",\n" +
        "    \"entities\": []\n" +
        "}"
    }
  },
  {
    "name": "data/docs.json",
    "value": {
      "content":
        "{\n" +
        "    \"dsp_spec_version\": \"0.5.0\",\n" +
        "    \"last_updated_by\": \"Specify\",\n" +
        "    \"last_updated\": \"Wed, 07 Oct 2020 08:04:22 GMT\",\n" +
        "    \"entities\": []\n" +
        "}"
    }
  },
  {
    "name": "dsp.json",
    "value": {
      "content":
        "{\n" +
        "    \"dsp_spec_version\": \"0.5.0\",\n" +
        "    \"last_updated_by\": \"Specify\",\n" +
        "    \"last_updated\": \"Wed, 07 Oct 2020 08:02:10 GMT\",\n" +
        "    \"import\": [\n" +
        "        {\n" +
        "            \"src\": \"data/tokens.json.json\"\n" +
        "        },\n" +
        "        {\n" +
        "            \"src\": \"data/components.json.json\"\n" +
        "        },\n" +
        "        {\n" +
        "            \"src\": \"data/fonts.json.json\"\n" +
        "        },\n" +
        "        {\n" +
        "            \"src\": \"data/docs.json.json\"\n" +
        "        }\n" +
        "    ],\n" +
        "    \"settings\": {\n" +
        "        \"name\": \"My DSP\",\n" +
        "        \"build_status_label\": \"test\",\n" +
        "        \"package_version\": \"0.0.1\",\n" +
        "        \"snippet_trigger_prefix\": \"ex-\"\n" +
        "    }\n" +
        "}"
    }
  }
]
```
